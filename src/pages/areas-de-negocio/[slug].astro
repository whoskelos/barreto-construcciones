---
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import Layout from "../../layouts/Layout.astro";
import CallToAction from "@components/sections/CallToAction.astro";
import ServiceHero from "@components/sections/ServiceHero.astro";

// Icons
import CheckIcon from "@assets/svg/check-circle.svg";
import FileIcon from "@assets/svg/file-text.svg";
import KeyIcon from "@assets/svg/key.svg";
import ShieldIcon from "@assets/svg/shield.svg";
import EyeIcon from "@assets/svg/eye.svg";
import FileCheckIcon from "@assets/svg/file-check.svg";
import BankNoteIcon from "@assets/svg/banknote.svg";
import PanelsIcon from "@assets/svg/panels.svg";
import CreditCardIcon from "@assets/svg/credit-card.svg";

export const prerender = true;

export async function getStaticPaths() {
    const services = await getCollection("services");
    return services.map((service) => ({
        params: { slug: service.id },
        props: { service },
    }));
}

const { service } = Astro.props;
const { data } = service;

const iconMap: Record<string, any> = {
    "check-circle": CheckIcon,
    "file-text": FileIcon,
    "key": KeyIcon,
    "shield": ShieldIcon,
    "eye": EyeIcon,
    "file-check": FileCheckIcon,
    "banknote": BankNoteIcon,
    "panels": PanelsIcon,
    "credit-card": CreditCardIcon,
};
---

<Layout
    title={data.seo.title}
    description={data.seo.description}
    keywords={data.seo.keywords}
    canonical={`/areas-de-negocio/${service.id}`}
>
    <ServiceHero
        title={data.title}
        HeroImage={data.heroImage}
        nameTransition={data.nameTransition}
    />
    <section
        class="container mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24 grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center"
    >
        <div class="space-y-6 md:space-y-8">
            <span
                class="inline-block text-primary-500 text-xs sm:text-sm font-semibold uppercase tracking-wider mb-3 md:mb-4"
                >Caracter√≠sticas</span
            >
            <h3
                class="text-neutral-900 text-3xl sm:text-4xl md:text-5xl font-bold mb-4 md:mb-6"
            >
                {data.introTitle}
            </h3>
            <div class="space-y-4">
                <p
                    class="text-neutral-600 text-base sm:text-lg leading-relaxed"
                >
                    {data.introDescription}
                </p>
            </div>
            <ul class="flex flex-col space-y-6 md:space-y-8">
                {data.features.map((feature) => {
                    const Icon = iconMap[feature.icon];
                    return (
                        <li class="flex gap-4 items-start animate-fade-in">
                            <div
                                class="shrink-0 w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-primary-500/10 flex items-center justify-center"
                            >
                                {Icon && <Icon class="w-6 h-6 sm:w-7 sm:h-7 text-primary-500" />}
                            </div>
                            <div class="flex-1">
                                <h4 class="text-lg sm:text-xl font-semibold mb-2">
                                    {feature.title}
                                </h4>
                                <p class="text-neutral-800 text-sm leading-relaxed">
                                    {feature.description}
                                </p>
                            </div>
                        </li>
                    );
                })}
            </ul>
        </div>
        <div
            class="relative h-[400px] sm:h-[500px] lg:h-[600px] rounded-lg overflow-hidden shadow-xl"
        >
            <Image
                class="w-full h-full object-cover"
                src={data.corporativoImage}
                alt="Imagen corporativa"
                loading="lazy"
                quality={80}
                widths={[400, 600, 800, 1000]}
                sizes="(max-width: 640px) 400px, (max-width: 1024px) 500px, 600px"
                format="avif"
            />
        </div>
    </section>
    <CallToAction />
</Layout>
